"""
常量定义模块
定义支持的日期格式、时间周期、编码等常量
"""

# 日期格式正则表达式（按优先级顺序）
# 年份范围：1900-3000，月份：01-12，日期：01-31
# 优先级：更严格的格式（补零）放在前面，宽松格式（不补零）放在后面
DATE_FORMATS = {
    # 年月格式（6位数字或 7位带横线）
    # 年份范围：1900-3000，月份：01-12（必须补零）
    'yyyyMM': r'^(19\d{2}|2\d{3}|3000)(0[1-9]|1[0-2])$',
    'yyyy-MM': r'^(19\d{2}|2\d{3}|3000)-(0[1-9]|1[0-2])$',

    # 最严格：时分秒都有，月份日期补零
    'yyyy/MM/dd HH:mm:ss': r'^(19\d{2}|2\d{3}|3000)/(0[1-9]|1[0-2])/(0[1-9]|[12][0-9]|3[01])\s+([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$',
    'yyyy-MM-dd HH:mm:ss': r'^(19\d{2}|2\d{3}|3000)-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])\s+([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$',
    'yyyyMMdd HH:mm:ss': r'^(19\d{2}|2\d{3}|3000)(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])\s+([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$',

    # 时分（无秒），月份日期补零
    'yyyy/MM/dd HH:mm': r'^(19\d{2}|2\d{3}|3000)/(0[1-9]|1[0-2])/(0[1-9]|[12][0-9]|3[01])\s+([01][0-9]|2[0-3]):[0-5][0-9]$',
    'yyyy-MM-dd HH:mm': r'^(19\d{2}|2\d{3}|3000)-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])\s+([01][0-9]|2[0-3]):[0-5][0-9]$',

    # 时分秒，月份日期不补零
    'yyyy/M/d HH:mm:ss': r'^(19\d{2}|2\d{3}|3000)/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{2}:\d{2}$',
    'yyyy-M-d HH:mm:ss': r'^(19\d{2}|2\d{3}|3000)-\d{1,2}-\d{1,2}\s+\d{1,2}:\d{2}:\d{2}$',

    # 时分（无秒），月份日期不补零
    'yyyy/M/d HH:mm': r'^(19\d{2}|2\d{3}|3000)/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{2}$',
    'yyyy-M-d HH:mm': r'^(19\d{2}|2\d{3}|3000)-\d{1,2}-\d{1,2}\s+\d{1,2}:\d{2}$',

    # 纯日期，月份日期补零
    'yyyy/MM/dd': r'^(19\d{2}|2\d{3}|3000)/(0[1-9]|1[0-2])/(0[1-9]|[12][0-9]|3[01])$',
    'yyyy-MM-dd': r'^(19\d{2}|2\d{3}|3000)-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$',
    'yyyyMMdd': r'^(19\d{2}|2\d{3}|3000)(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])$',

    # 纯日期，月份日期不补零
    'yyyy/M/d': r'^(19\d{2}|2\d{3}|3000)/\d{1,2}/\d{1,2}$',
    'yyyy-M-d': r'^(19\d{2}|2\d{3}|3000)-\d{1,2}-\d{1,2}$',
}

# 日期格式对应的 pandas 格式字符串
DATE_FORMAT_STRINGS = [
    '%Y%m',         # 年月格式（yyyyMM）如 202401
    '%Y-%m',        # 年月格式（yyyy-MM）如 2024-01
    '%Y%m%d',      # 完整日期（yyyyMMdd）如 20240115
    '%Y-%m-%d',     # 完整日期（yyyy-MM-dd）如 2024-01-15
    '%Y/%m/%d',     # 完整日期（yyyy/MM/dd）如 2024/01/15
    '%Y%m%d %H:%M:%S',  # 日期时间（yyyyMMdd HH:mm:ss）
    '%Y-%m-%d %H:%M:%S',  # 日期时间（yyyy-MM-dd HH:mm:ss）
    '%Y/%m/%d %H:%M:%S',  # 日期时间（yyyy/MM/dd HH:mm:ss）
]

# 支持的时间周期类型
TIME_PERIODS = {
    'Y': '年',
    'H': '半年',
    'Q': '季度',
    'M': '月',
    'HM': '半月',
    'D': '日',
}

# 时间周期描述
TIME_PERIOD_DESCRIPTIONS = {
    'Y': '按年份拆分',
    'H': '按上半年(H1)/下半年(H2)拆分',
    'Q': '按季度拆分',
    'M': '按月份拆分',
    'HM': '按上半月(1-15日)/下半月(16-月末)拆分',
    'D': '按日期拆分',
}

# 默认值
DEFAULT_MAX_ROWS = 500000
DEFAULT_OUTPUT_DIR = './split_data'
DEFAULT_TIME_PERIOD = 'M'
DEFAULT_ENCODING = 'auto'

# 文件名最大长度
MAX_FILENAME_LENGTH = 100

# 支持的编码列表（按优先级）
SUPPORTED_ENCODINGS = ['utf-8', 'gbk', 'gb2312', 'latin1']

# 不安全的文件名字符
UNSAFE_FILENAME_CHARS = ['/', '\\', ':', '*', '?', '"', '<', '>', '|']

# 日期字段检测阈值
DATE_DETECTION_THRESHOLD = 0.8
