# CSV 智能拆分工具 - PyQt6 桌面端界面设计文档

> **版本**: v2.0 | **更新日期**: 2025-01-26 | **设计师**: Claude (UX/UI Designer Expert)

---

## 📋 目录

1. [设计理念](#1-设计理念)
2. [用户流程设计](#2-用户流程设计)
3. [界面布局设计](#3-界面布局设计)
4. [组件设计规范](#4-组件设计规范)
5. [主题色彩方案](#5-主题色彩方案)
6. [交互设计细节](#6-交互设计细节)
7. [响应式设计](#7-响应式设计)
8. [无障碍设计](#8-无障碍设计)
9. [技术实现建议](#9-技术实现建议)

---

## 1. 设计理念

### 1.1 设计愿景

**打造一款让数据分析师"零学习成本"的 CSV 拆分工具**

我们的设计哲学基于以下核心原则：

#### 🎯 **以用户为中心**
- **理解用户心理模型**：数据分析师习惯"文件 → 字段 → 操作"的线性思维
- **减少认知负荷**：每屏只聚焦一个核心任务，避免信息过载
- **尊重用户习惯**：遵循桌面应用的标准交互模式（Ctrl+O 打开文件等）

#### ✨ **优雅的简洁性**
- **渐进式披露**：高级功能默认隐藏，需要时才展开
- **视觉层次清晰**：通过大小、颜色、间距建立明确的视觉优先级
- **留白的艺术**：充足的空间让界面呼吸，提升阅读舒适度

#### 🚀 **高效的反馈**
- **即时响应**：每个操作都有明确的视觉反馈
- **进度可视化**：长时间操作显示详细进度，而非无响应等待
- **友好的错误处理**：错误信息不仅说明"什么错了"，还指导"如何解决"

#### 🎨 **现代审美**
- **扁平化设计**：参考 VS Code、Notion、Linear 的简洁风格
- **微动效**：适度的过渡动画提升品质感，但不影响性能
- **深浅主题**：支持浅色/深色/自动主题，适应不同工作环境

### 1.2 设计语言参考

| 应用 | 借鉴元素 |
|------|---------|
| **VS Code** | 侧边栏导航、命令面板、深色主题配色 |
| **Notion** | 卡片式布局、极简图标、优雅的排版 |
| **Linear** | 流畅的动画过渡、精致的细节处理 |
| **Figma** | 直观的属性面板、实时预览 |

### 1.3 技术栈

| 组件 | 选择 | 理由 |
|------|------|------|
| **UI 框架** | PyQt6 | 跨平台、原生性能、丰富的组件库 |
| **图标库** | Fluent UI Icons | 现代化、语义清晰、风格一致 |
| **图表库** | QtCharts (可选) | 原生集成、轻量级 |
| **配置存储** | QSettings | 跨平台、自动处理路径问题 |
| **多线程** | QThread + QThreadPool | 避免界面冻结、进度实时更新 |

---

## 2. 用户流程设计

### 2.1 用户画像

#### 👤 **主要用户：数据分析师 Sarah**

| 属性 | 描述 |
|------|------|
| **年龄** | 28-45 岁 |
| **职业** | 数据分析师 / 运营专员 |
| **技术水平** | 中等（熟悉 Excel，会基础 SQL） |
| **工作场景** | 每月需要拆分大型 CSV 文件发送给各区域负责人 |
| **痛点** | 手动拆分效率低，容易出错；命令行工具学习成本高；需要频繁调整拆分规则，重复劳动 |
| **期望** | 3 分钟内完成一次拆分任务；能够保存常用配置，一键复用；清晰的预览，避免拆分错误；友好的错误提示 |

### 2.2 核心用户流程

```
启动应用 → 选择文件 → 配置字段 → 拆分设置 → 预览确认 → 执行拆分 → 查看结果
```

### 2.3 决策流程

```
选择字段
    │
    ▼
有日期字段？
    │
    ├─ 是 → 显示时间周期选项
    │        │
    │        ▼
    │   仅日期字段？
    │        │
    │        ├─ 是 → 纯时间拆分
    │        └─ 否 → 字段 + 时间组合拆分
    │
    └─ 否 → 仅按字段拆分
```

---

## 3. 界面布局设计

### 3.1 主窗口结构

```
┌────────────────────────────────────────────────────────────────────────────────┐
│  CSV 智能拆分工具 v2.1                                        ─ □ ×           │
├────────────────────────────────────────────────────────────────────────────────┤
│  ┌────────────┐ ┌──────────────────────────────────────────────────────────┐  │
│  │   侧边栏    │ │                   主内容区                               │  │
│  │            │ │                                                          │  │
│  │ 🏠 首页    │ │  ┌────────────────────────────────────────────────────┐  │  │
│  │ 📁 文件    │ │  │              页面内容区                             │  │  │
│  │ 📋 字段    │ │  │  ┌──────────────────────────────────────────────┐  │  │  │
│  │ ⚙️ 拆分    │ │ │  │  步骤导航器                                │  │  │  │
│  │ ▶️ 执行    │ │ │  │  • 选择文件 → 字段配置 → 拆分设置 → 预览确认  │  │  │  │
│  │ 📊 结果    │ │ │  │  └──────────────────────────────────────────────┘  │  │  │
│  │ 📜 历史    │ │ │  │                                                   │  │  │
│  │ ⚙️ 设置    │ │ │  │  ┌──────────────────────────────────────────────┐  │  │  │
│  │ ❓ 帮助    │ │ │  │  │          主要操作卡片                        │  │  │  │
│  │            │ │  │  └──────────────────────────────────────────────┘  │  │  │
│  └────────────┘ │  └────────────────────────────────────────────────────┘  │  │
│                │ └──────────────────────────────────────────────────────────┘  │
└────────────────┴──────────────────────────────────────────────────────────────┘
```

### 3.2 尺寸规范

| 属性 | 值 | 说明 |
|------|-----|------|
| **最小窗口尺寸** | 1100 × 750 | 保证所有内容可见 |
| **推荐窗口尺寸** | 1400 × 900 | 最佳视觉体验 |
| **侧边栏宽度** | 200px | 支持折叠（折叠后 60px） |
| **卡片圆角** | 8px | 现代化圆角 |
| **卡片阴影** | 0 2px 8px rgba(0,0,0,0.08) | 轻微浮起效果 |

---

## 4. 组件设计规范

### 4.1 按钮

#### 主要按钮（Primary Button）

```
┌──────────────────┐
│   ▶️ 开始拆分     │
└──────────────────┘

• 背景: #007ACC (主色)
• 文字: #FFFFFF (白色)
• 高度: 36px
• 圆角: 4px
• 悬停: 背景加深至 #005A9E
• 点击: 轻微缩放效果 (0.98)
```

#### 次要按钮（Secondary Button）

```
┌──────────────────┐
│      取消         │
└──────────────────┘

• 背景: 透明
• 边框: 1px #E0E0E0
• 文字: #333333
• 悬停: 背景 #F5F5F5
```

#### 图标按钮

```
┌───┐ ┌───┐ ┌───┐
│📂 │ │🔄 │ │🗑️ │
└───┘ └───┘ └───┘

• 尺寸: 32×32px
• 圆角: 4px
• 悬停: 背景 #F5F5F5
```

### 4.2 输入框

#### 标准输入框

```
┌────────────────────────────────────────┐
│ C:\data\orders.csv                ×    │
└────────────────────────────────────────┘

• 高度: 32px
• 边框: 1px #E0E0E0
• 聚焦边框: 2px #007ACC
• 内边距: 8px 12px
• 圆角: 4px
```

#### 带浏览按钮的输入框

```
┌─────────────────────────────────────┐ ┌──────────┐
│ C:\data\orders.csv            ×    │ │ 浏览...  │
└─────────────────────────────────────┘ └──────────┘
```

### 4.3 复选框和单选框

#### 复选框

```
☑ 包含子文件夹
☐ 自动检测编码

• 选中: 蓝色勾选标记
• 悬停: 边框高亮
```

#### 单选框

```
● 月 (M)
○ 季度 (Q)
○ 年 (Y)

• 选中: 蓝色圆点
• 同组互斥
```

### 4.4 进度条

#### 标准进度条

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
67% │██████████████████████████████████████░░░░░░░░░░│ 100/150

• 高度: 8px
• 圆角: 4px
• 颜色: #007ACC
• 背景: #E0E0E0
```

### 4.5 表格

```
┌────┬──────────────┬──────────┬──────────────────┐
│    │ 字段名        │ 类型     │ 样例值           │
├────┼──────────────┼──────────┼──────────────────┤
│☑   │ 订单号        │ 📝 普通  │ ORD00000001     │
│☑   │ 省份          │ 📝 普通  │ 上海市          │
│☑   │ 订单日期      │ 📅 日期  │ 2024-07-30      │
└────┴──────────────┴──────────┴──────────────────┘

• 表头背景: #F5F5F5
• 交替行色: #FAFAFA
• 选中行: #E3F2FD
• 行高: 40px
```

### 4.6 卡片

```
┌────────────────────────────────────────┐
│  📋 配置摘要                            │
│  ────────────────────────────────────  │
│  输入文件: orders.csv                  │
│  拆分字段: 省份 → 城市 → 订单日期      │
│  预计输出: 约 150 个文件               │
└────────────────────────────────────────┘

• 背景: #FFFFFF
• 圆角: 8px
• 阴影: 0 2px 8px rgba(0,0,0,0.08)
• 内边距: 16px
```

### 4.7 消息提示

#### 成功消息

```
┌────────────────────────────────────────┐
│  ✅ 拆分完成！                          │
│  成功处理 1,500,000 行数据              │
└────────────────────────────────────────┘

• 边框: #4CAF50
• 背景: #E8F5E9
• 图标: 绿色勾选
```

#### 错误消息

```
┌────────────────────────────────────────┐
│  ❌ 错误                                │
│  文件读取失败：编码检测失败             │
│  [重试] [查看详情]                     │
└────────────────────────────────────────┘

• 边框: #F44336
• 背景: #FFEBEE
• 图标: 红色叉号
```

#### 警告消息

```
┌────────────────────────────────────────┐
│  ⚠️ 警告                                │
│  输出目录已存在，是否覆盖？             │
│  [是，覆盖] [取消]                     │
└────────────────────────────────────────┘

• 边框: #FF9800
• 背景: #FFF3E0
• 图标: 橙色警告
```

---

## 5. 主题色彩方案

### 5.1 浅色主题（Light Theme）

```css
/* 主色 */
--primary: #007ACC;              /* 蓝色 - 主要操作、链接 */
--primary-hover: #005A9E;        /* 深蓝 - 悬停状态 */
--primary-light: #E3F2FD;        /* 浅蓝 - 背景、高亮 */

/* 语义色 */
--success: #4CAF50;              /* 绿色 - 成功 */
--warning: #FF9800;              /* 橙色 - 警告 */
--error: #F44336;                /* 红色 - 错误 */
--info: #2196F3;                 /* 信息蓝 */

/* 背景色 */
--bg-primary: #FFFFFF;           /* 主背景 */
--bg-secondary: #F5F5F5;         /* 次要背景 */
--bg-tertiary: #FAFAFA;          /* 第三级背景 */
--bg-elevated: #FFFFFF;          /* 浮起层背景 */

/* 文字色 */
--text-primary: #333333;         /* 主文字 */
--text-secondary: #666666;       /* 次要文字 */
--text-tertiary: #999999;        /* 辅助文字 */
--text-disabled: #CCCCCC;        /* 禁用文字 */

/* 边框色 */
--border-light: #E0E0E0;         /* 浅边框 */
--border-medium: #BDBDBD;        /* 中边框 */
--border-dark: #9E9E9E;          /* 深边框 */

/* 侧边栏 */
--sidebar-bg: #2D2D30;           /* 侧边栏背景 */
--sidebar-text: #CCCCCC;         /* 侧边栏文字 */
--sidebar-hover: #3E3E42;        /* 侧边栏悬停 */
--sidebar-active: #094771;       /* 侧边栏激活 */
```

### 5.2 深色主题（Dark Theme）

```css
/* 主色 */
--primary: #3A8DDE;              /* 亮蓝色 */
--primary-hover: #5CA3E8;        /* 更亮蓝 */
--primary-light: #1E3A5F;        /* 深蓝背景 */

/* 语义色 */
--success: #66BB6A;              /* 亮绿色 */
--warning: #FFA726;              /* 亮橙色 */
--error: #EF5350;                /* 亮红色 */
--info: #42A5F5;                 /* 亮信息蓝 */

/* 背景色 */
--bg-primary: #1E1E1E;           /* 主背景 */
--bg-secondary: #252526;         /* 次要背景 */
--bg-tertiary: #2D2D30;          /* 第三级背景 */
--bg-elevated: #333333;          /* 浮起层背景 */

/* 文字色 */
--text-primary: #CCCCCC;         /* 主文字 */
--text-secondary: #999999;       /* 次要文字 */
--text-tertiary: #666666;        /* 辅助文字 */
--text-disabled: #444444;        /* 禁用文字 */

/* 边框色 */
--border-light: #3E3E42;         /* 浅边框 */
--border-medium: #4E4E52;        /* 中边框 */
--border-dark: #5E5E62;          /* 深边框 */

/* 侧边栏 */
--sidebar-bg: #202020;           /* 侧边栏背景 */
--sidebar-text: #CCCCCC;         /* 侧边栏文字 */
--sidebar-hover: #2A2A2D;        /* 侧边栏悬停 */
--sidebar-active: #3A8DDE;       /* 侧边栏激活 */
```

### 5.3 主题切换

- **自动主题**: 根据系统主题自动切换
- **手动切换**: 设置中可选择浅色/深色/自动
- **切换动画**: 300ms 平滑过渡

---

## 6. 交互设计细节

### 6.1 状态反馈

#### 按钮状态

| 状态 | 视觉表现 |
|------|---------|
| **默认** | 正常显示 |
| **悬停** | 背景变色，光标变为手指 |
| **按下** | 轻微缩放 (0.98) |
| **聚焦** | 2px 主色边框 |
| **禁用** | 50% 不透明度，斜线光标 |
| **加载中** | 显示旋转图标，禁用点击 |

#### 输入框状态

| 状态 | 视觉表现 |
|------|---------|
| **默认** | 灰色边框 |
| **聚焦** | 主色边框，外发光效果 |
| **错误** | 红色边框，显示错误提示 |
| **禁用** | 灰色背景，不可编辑 |

### 6.2 动画效果

#### 页面切换

```css
/* 淡入淡出 */
opacity: 0 → 1
duration: 200ms
easing: ease-in-out
```

#### 卡片展开/收起

```css
/* 高度变化 */
height: 0 → auto
duration: 300ms
easing: cubic-bezier(0.4, 0, 0.2, 1)
```

#### 进度条更新

```css
/* 平滑过渡 */
width: current → new
duration: 100ms
easing: linear
```

#### 侧边栏折叠

```css
/* 宽度变化 */
width: 200px → 60px
duration: 250ms
easing: ease-in-out
```

### 6.3 快捷键

| 快捷键 | 功能 |
|-------|------|
| `Ctrl + O` | 打开文件 |
| `Ctrl + S` | 保存配置 |
| `Ctrl + N` | 新建任务 |
| `Ctrl + ,` | 打开设置 |
| `Ctrl + Q` | 退出程序 |
| `Ctrl + W` | 关闭当前页面 |
| `Alt + 1~9` | 切换侧边栏页面 |
| `Alt + →` | 下一步 |
| `Alt + ←` | 上一步 |
| `Ctrl + A` | 全选 |
| `Delete` | 删除选中项 |
| `F5` | 刷新 |
| `Esc` | 取消/关闭对话框 |
| `Ctrl + [` | 收起/展开侧边栏 |

### 6.4 拖拽交互

#### 字段排序

```
1. 鼠标悬停在字段行上
2. 光标变为移动图标
3. 按住鼠标左键拖动
4. 显示插入位置指示器
5. 释放鼠标完成排序
```

#### 文件拖放

```
1. 从文件管理器拖动文件
2. 拖到应用窗口上
3. 显示拖放区域高亮
4. 释放鼠标加载文件
```

---

## 7. 响应式设计

### 7.1 窗口尺寸适配

| 窗口宽度 | 侧边栏 | 主内容区 | 布局调整 |
|---------|--------|----------|---------|
| ≥1400px | 200px | 正常显示 | 完整布局 |
| 1200-1399px | 180px | 正常显示 | 侧边栏略窄 |
| 1000-1199px | 可折叠 | 正常显示 | 侧边栏默认折叠 |
| <1000px | 隐藏 | 全屏 | 抽屉式导航 |

### 7.2 字体缩放

```css
/* 字体大小基准 */
--font-size-xs: 12px;   /* 高密度屏幕 */
--font-size-sm: 13px;   /* 小屏 */
--font-size-base: 14px; /* 默认 */
--font-size-lg: 16px;   /* 大屏 */
--font-size-xl: 18px;   /* 超大屏 */
```

### 7.3 高DPI支持

- 自动检测系统DPI设置
- 图标使用SVG或高分辨率位图
- 布局使用相对单位

---

## 8. 无障碍设计

### 8.1 键盘导航

- 所有交互元素支持Tab键导航
- 焦点顺序符合逻辑流程
- 焦点可见（蓝色边框高亮）
- 支持方向键在列表中移动

### 8.2 屏幕阅读器支持

- 所有按钮有描述性标签
- 图标有文字说明或alt属性
- 进度变化有语音提示
- 表格有行/列标题

### 8.3 颜色对比度

- 正常文本对比度 ≥ 4.5:1
- 大文本对比度 ≥ 3:1
- 非文本元素对比度 ≥ 3:1

### 8.4 高对比度模式

```
/* 高对比度配色 */
--high-contrast-primary: #FFFF00;   /* 黄色 */
--high-contrast-bg: #000000;        /* 黑色 */
--high-contrast-text: #FFFFFF;      /* 白色 */
--high-contrast-border: #FFFFFF;    /* 白色 */
```

---

## 9. 技术实现建议

### 9.1 PyQt6组件选择

| 功能 | 组件 | 说明 |
|------|------|------|
| 主窗口 | QMainWindow | 标准主窗口框架 |
| 侧边栏 | QListWidget | 导航列表 |
| 文件选择 | QLineEdit + QPushButton | 自定义文件选择器 |
| 字段列表 | QTableWidget | 可多选表格 |
| 进度条 | QProgressBar | 标准进度条 |
| 卡片容器 | QFrame + QVBoxLayout | 自定义卡片 |
| 设置页面 | QTabWidget | 分类设置 |

### 9.2 多线程架构

```python
# 线程架构
主线程 (GUI事件循环)
    │
    ├─── 工作线程 (QThread) - CSV处理
    │         │
    │         ├─── 文件读取
    │         ├─── 字段分析
    │         ├─── 数据拆分
    │         └─── 文件写入
    │
    └─── 信号/槽通信
              │
              └─── 进度更新到主线程
```

### 9.3 配置持久化

```python
# 使用 QSettings
settings = QSettings("CSVSplitter", "Config")

# 保存配置
settings.setValue("output_dir", "/path/to/output")
settings.setValue("default_encoding", "UTF-8")
settings.setValue("theme", "dark")

# 读取配置
output_dir = settings.value("output_dir", "")
```

### 9.4 样式表实现

```python
# 使用 QSS (Qt Style Sheets)
STYLESHEET = """
QPushButton {
    background-color: #007ACC;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 16px;
    min-height: 36px;
}

QPushButton:hover {
    background-color: #005A9E;
}

QPushButton:pressed {
    background-color: #004578;
}

QPushButton:disabled {
    background-color: #CCCCCC;
    color: #666666;
}
"""

app.setStyleSheet(STYLESHEET)
```

### 9.5 性能优化

| 优化项 | 方案 |
|-------|------|
| 大文件预览 | 只显示前1000行 |
| 文件列表 | 虚拟滚动 |
| 进度更新 | 限制刷新频率（100ms） |
| 长时间操作 | 使用后台线程 |
| 图标资源 | 使用共享实例 |

---

## 10. 附录

### 10.1 设计交付物

1. **设计原型** (Figma/Sketch)
   - 高保真交互原型
   - 所有页面状态
   - 动画演示

2. **设计规范** (Design Tokens)
   - 颜色变量
   - 字体规范
   - 间距系统
   - 组件样式

3. **图标资源** (Icons)
   - SVG格式图标
   - 多尺寸版本
   - 浅/深色主题版本

4. **开发文档**
   - 组件API文档
   - 样式指南
   - 交互说明

### 10.2 开发阶段

| 阶段 | 任务 | 优先级 | 预计工时 |
|-----|------|--------|---------|
| 1 | 搭建基础框架 | P0 | 2天 |
| 2 | 实现首页 | P0 | 1天 |
| 3 | 实现文件选择页面 | P0 | 2天 |
| 4 | 实现字段配置页面 | P0 | 3天 |
| 5 | 实现拆分设置页面 | P0 | 2天 |
| 6 | 实现预览确认页面 | P0 | 2天 |
| 7 | 实现执行进度页面 | P0 | 3天 |
| 8 | 实现结果展示页面 | P1 | 2天 |
| 9 | 实现历史记录功能 | P1 | 2天 |
| 10 | 实现设置页面 | P2 | 2天 |
| 11 | 实现帮助页面 | P2 | 1天 |
| 12 | 主题切换功能 | P2 | 2天 |
| 13 | 快捷键支持 | P3 | 1天 |
| 14 | 无障碍优化 | P3 | 2天 |
| 15 | 测试与调优 | P0 | 3天 |

### 10.3 验收标准

#### 功能验收

- ✅ 所有页面正常显示
- ✅ 所有交互功能正常工作
- ✅ 拆分功能与命令行版本一致
- ✅ 进度显示准确
- ✅ 错误处理完善

#### 性能验收

- ✅ 界面响应时间 < 100ms
- ✅ 大文件（100万行）处理不卡顿
- ✅ 内存占用合理（<500MB）
- ✅ 启动时间 < 2秒

#### 兼容性验收

- ✅ Windows 10/11 正常运行
- ✅ macOS 12+ 正常运行
- ✅ Ubuntu 20.04+ 正常运行
- ✅ 高DPI屏幕正常显示

#### UX验收

- ✅ 新用户5分钟内完成首次拆分
- ✅ 错误信息清晰易懂
- ✅ 快捷键功能完整
- ✅ 键盘导航流畅

---

**文档版本**: v2.0  
**最后更新**: 2025-01-26  
**维护者**: CSV Splitter Design Team  
**许可**: MIT License

---

📧 **反馈与建议**

如有任何设计建议或发现问题，欢迎通过以下方式联系：

- GitHub Issues: https://github.com/junstudys/split_csv_by_field/issues
- Email: support@example.com

---

*本设计文档遵循现代化UX/UI设计原则，参考了VS Code、Notion、Linear等优秀应用的设计理念，旨在为用户提供简洁、高效、愉悦的使用体验。*
