# CSV Splitter - æ™ºèƒ½CSVæ–‡ä»¶æ‹†åˆ†å·¥å…·

> æŒ‰å­—æ®µå†…å®¹ã€æ—¶é—´å‘¨æœŸæ™ºèƒ½æ‹†åˆ†å¤§å‹CSVæ–‡ä»¶

## ç‰ˆæœ¬ä¿¡æ¯

**å½“å‰ç‰ˆæœ¬**: v2.1

## åŠŸèƒ½ç‰¹æ€§

### æ‹†åˆ†ç­–ç•¥
- âœ… å•å­—æ®µæ‹†åˆ†
- âœ… å¤šå­—æ®µçº§è”æ‹†åˆ†
- âœ… å­—æ®µ + æ—¶é—´ç»„åˆæ‹†åˆ†
- âœ… çº¯æ—¶é—´å‘¨æœŸæ‹†åˆ†

### æ—¶é—´å‘¨æœŸæ”¯æŒ
| å‘¨æœŸ | å‚æ•° | è¯´æ˜ | è¾“å‡ºç¤ºä¾‹ |
|-----|------|------|---------|
| å¹´ | Y | æŒ‰å¹´ä»½æ‹†åˆ† | `sample_2024.csv` |
| åŠå¹´ | H | æŒ‰åŠå¹´æ‹†åˆ† | `sample_2024-H1.csv`, `sample_2024-H2.csv` |
| å­£åº¦ | Q | æŒ‰å­£åº¦æ‹†åˆ† | `sample_2024-Q1.csv` ~ `sample_2024-Q4.csv` |
| æœˆ | M | æŒ‰æœˆä»½æ‹†åˆ†ï¼ˆé»˜è®¤ï¼‰ | `sample_2024-01.csv` ~ `sample_2024-12.csv` |
| åŠæœˆ | HM | æŒ‰åŠæœˆæ‹†åˆ† | `sample_2024-01-HM1.csv`, `sample_2024-01-HM2.csv` |
| æ—¥ | D | æŒ‰æ—¥æœŸæ‹†åˆ† | `sample_2024-01-15.csv` |

### æ—¥æœŸæ ¼å¼æ”¯æŒ
| æ ¼å¼ | ç¤ºä¾‹ |
|-----|------|
| yyyyMMdd | 20240115 |
| yyyy-MM-dd | 2024-01-15 |
| yyyy/MM/dd | 2024/01/15 |
| yyyy-M-d | 2024-1-15, 2024-12-5 |
| yyyy/M/d | 2024/1/15, 2024/12/5 |
| yyyyMMdd HH:mm:ss | 20240115 14:30:00 |
| yyyy-MM-dd HH:mm:ss | 2024-01-15 14:30:00 |
| yyyy/MM/dd HH:mm:ss | 2024/01/15 14:30:00 |
| yyyy-M-d HH:mm:ss | 2024-1-15 14:30:06 |
| yyyy/M/d HH:mm:ss | 2024/1/15 14:30:06 |
| yyyy-MM-dd HH:mm | 2024-01-15 14:30 |
| yyyy/MM/dd HH:mm | 2024/01/15 14:30 |
| yyyy-M-d HH:mm | 2024-1-15 14:30 |
| yyyy/M/d HH:mm | 2024/1/15 14:30 |

### å…¶ä»–åŠŸèƒ½
- âœ… å¤§æ–‡ä»¶è‡ªåŠ¨äºŒæ¬¡æ‹†åˆ†ï¼ˆé»˜è®¤50ä¸‡è¡Œï¼‰
- âœ… å•æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†
- âœ… è‡ªåŠ¨ç¼–ç æ£€æµ‹
- âœ… é€’å½’å¤„ç†å­æ–‡ä»¶å¤¹
- âœ… è¿›åº¦æ˜¾ç¤ºä¸è¯¦ç»†æ—¥å¿—

## å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/junstudys/split_csv_by_field
cd split_csv_by_field

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

## å¿«é€Ÿå¼€å§‹

ç¤ºä¾‹æ•°æ®ç»“æ„ (`./data/sample.csv`)ï¼š

```
è®¢å•å·,è®¢å•æ—¥æœŸ,è®¢å•æ—¶é—´,ç»“ç®—æ—¥æœŸ,ç½‘ç‚¹,çœä»½,åŸå¸‚,é‡‘é¢,æ•°é‡,å¤‡æ³¨
ORD00000001,2024-07-30,2024/7/30 11:24,2024/8/9,ç½‘ç‚¹D,ä¸Šæµ·å¸‚,ä¸Šæµ·å¸‚,392.17,89,å¤‡æ³¨ä¿¡æ¯0
ORD00000002,2025-03-27,2025/3/27 11:29,2025/4/6,ç½‘ç‚¹E,ä¸Šæµ·å¸‚,ä¸Šæµ·å¸‚,927.31,22,å¤‡æ³¨ä¿¡æ¯1
...
```

### 1. æŸ¥çœ‹æ–‡ä»¶å­—æ®µ

```bash
python csv_splitter.py list-fields --file ./data/sample.csv
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“‹ æ–‡ä»¶å­—æ®µåˆ—è¡¨
============================================================
æ–‡ä»¶: ./data/sample.csv
ç¼–ç : utf-8

æ€»å­—æ®µæ•°: 10
============================================================
   1. ğŸ“ æ™®é€š | è®¢å•å·                        | æ ·ä¾‹: ORD00000001
   2. ğŸ“… æ—¥æœŸ | è®¢å•æ—¥æœŸ                      | æ ·ä¾‹: 2024-07-30
   3. ğŸ“… æ—¥æœŸ | è®¢å•æ—¶é—´                      | æ ·ä¾‹: 2024/7/30 11:24
   4. ğŸ“… æ—¥æœŸ | ç»“ç®—æ—¥æœŸ                      | æ ·ä¾‹: 2024/8/9
   5. ğŸ“ æ™®é€š | ç½‘ç‚¹                          | æ ·ä¾‹: ç½‘ç‚¹D
   6. ğŸ“ æ™®é€š | çœä»½                          | æ ·ä¾‹: ä¸Šæµ·å¸‚
   7. ğŸ“ æ™®é€š | åŸå¸‚                          | æ ·ä¾‹: ä¸Šæµ·å¸‚
   8. ğŸ“ æ™®é€š | é‡‘é¢                          | æ ·ä¾‹: 392.17
   9. ğŸ“ æ™®é€š | æ•°é‡                          | æ ·ä¾‹: 89
  10. ğŸ“ æ™®é€š | å¤‡æ³¨                          | æ ·ä¾‹: å¤‡æ³¨ä¿¡æ¯0
```

### 2. æŒ‰çœä»½æ‹†åˆ†

```bash
python csv_splitter.py split --input ./data/sample.csv --split-fields "çœä»½"
```

è¾“å‡ºï¼š`sample_ä¸Šæµ·å¸‚.csv`ã€`sample_æµ™æ±Ÿçœ.csv`ã€`sample_æ²³å—çœ.csv`...

### 3. æŒ‰æœˆä»½æ‹†åˆ†

```bash
python csv_splitter.py split --input ./data/sample.csv --split-fields "è®¢å•æ—¥æœŸ" --time-period M
```

è¾“å‡ºï¼š`sample_2024-01.csv`ã€`sample_2024-02.csv`...

### 4. æŒ‰çœä»½ + æœˆä»½ç»„åˆæ‹†åˆ†

```bash
python csv_splitter.py split \
    --input ./data/sample.csv \
    --split-fields "çœä»½,è®¢å•æ—¥æœŸ" \
    --time-period M
```

è¾“å‡ºï¼š`sample_ä¸Šæµ·å¸‚_2024-01.csv`ã€`sample_æµ™æ±Ÿçœ_2024-02.csv`...

### 5. æŒ‰å­£åº¦æ‹†åˆ†

```bash
python csv_splitter.py split \
    --input ./data/sample.csv \
    --split-fields "è®¢å•æ—¥æœŸ" \
    --time-period Q
```

è¾“å‡ºï¼š`sample_2024-Q1.csv`ã€`sample_2024-Q2.csv`...

### 6. æŒ‰åŠæœˆæ‹†åˆ†

```bash
python csv_splitter.py split \
    --input ./data/sample.csv \
    --split-fields "è®¢å•æ—¥æœŸ" \
    --time-period HM
```

è¾“å‡ºï¼š`sample_2024-01-HM1.csv`ï¼ˆä¸ŠåŠæœˆï¼‰ã€`sample_2024-01-HM2.csv`ï¼ˆä¸‹åŠæœˆï¼‰...

### 7. å¤§æ–‡ä»¶äºŒæ¬¡æ‹†åˆ†ï¼ˆæ¡ˆä¾‹æŒ‰æ¯5è¡Œï¼Œå®é™…é»˜è®¤50ä¸‡è¡Œæ‹†åˆ†ï¼‰

```bash
python csv_splitter.py split \
    --input ./data/sample.csv \
    --split-fields "è®¢å•æ—¥æœŸ" \
    --time-period M \
    --max-rows 5
```

è¾“å‡ºï¼š`sample_2024-01_part1.csv`ï¼ˆ5è¡Œï¼‰ã€`sample_2024-01_part2.csv`ï¼ˆ5è¡Œï¼‰...

```bash
python csv_splitter.py split \
    --input ./data/sample.csv \
    --split-fields "çœä»½" \
    --time-period M \
    --max-rows 5
```

è¾“å‡ºï¼š`sample_ä¸Šæµ·å¸‚_part1.csv`ï¼ˆ5è¡Œï¼‰ã€`sample_ä¸Šæµ·å¸‚_part2.csv`ï¼ˆ5è¡Œï¼‰...

### 8. æ‰¹é‡å¤„ç†æ–‡ä»¶å¤¹

```bash
python csv_splitter.py split \
    --input ./data/ \
    --split-fields "è®¢å•æ—¥æœŸ" \
    --time-period Q \
    --recursive
```

### 9. æŒ‰çœä»½å’ŒåŸå¸‚çº§è”æ‹†åˆ†

```bash
python csv_splitter.py split \
    --input ./data/sample.csv \
    --split-fields "çœä»½,åŸå¸‚"
```

è¾“å‡ºï¼š`sample_ä¸Šæµ·å¸‚_ä¸Šæµ·å¸‚.csv`ã€`sample_æµ™æ±Ÿçœ_æ­å·å¸‚.csv`...

## å‚æ•°è¯´æ˜

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|-----|-------|------|
| `--input` | string | æ˜¯ | - | è¾“å…¥æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹è·¯å¾„ |
| `--split-fields` | string | æ˜¯ | - | æ‹†åˆ†å­—æ®µï¼Œé€—å·åˆ†éš”ï¼ˆå¦‚ï¼š"çœä»½,è®¢å•æ—¥æœŸ"ï¼‰|
| `--time-period` | string | å¦ | - | æ—¶é—´å‘¨æœŸï¼šY/H/Q/M/HM/Dï¼ˆä»…æ—¥æœŸå­—æ®µéœ€è¦ï¼‰|
| `--max-rows` | int | å¦ | None | å•æ–‡ä»¶æœ€å¤§è¡Œæ•°ï¼ŒNone=ä¸æ‹†åˆ† |
| `--output` | string | å¦ | ./split_data | è¾“å‡ºç›®å½• |
| `--recursive` | bool | å¦ | False | æ˜¯å¦é€’å½’å¤„ç†å­æ–‡ä»¶å¤¹ |
| `--encoding` | string | å¦ | auto | æ–‡ä»¶ç¼–ç ï¼šauto/utf-8/gbk/gb2312 |

## é¡¹ç›®ç»“æ„

```
split_csv_by_field/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli.py                    # CLI å…¥å£
â”‚   â”œâ”€â”€ splitter/                 # æ‹†åˆ†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ csv_splitter.py       # æ ¸å¿ƒæ‹†åˆ†ç±»
â”‚   â””â”€â”€ utils/                    # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ constants.py          # å¸¸é‡å®šä¹‰
â”‚       â”œâ”€â”€ date_utils.py         # æ—¥æœŸå·¥å…·
â”‚       â””â”€â”€ file_utils.py         # æ–‡ä»¶å·¥å…·
â”œâ”€â”€ csv_splitter.py               # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ requirements.txt              # ä¾èµ–æ¸…å•
â”œâ”€â”€ README.md                     # æœ¬æ–‡ä»¶
â”œâ”€â”€ data/                         # ç¤ºä¾‹æ•°æ®
â”‚   â””â”€â”€ sample.csv                # è®¢å•æ•°æ®æ ·ä¾‹
â””â”€â”€ tests/                        # æµ‹è¯•ç›®å½•
    â”œâ”€â”€ test_date_utils.py
    â”œâ”€â”€ test_file_utils.py
    â””â”€â”€ test_csv_splitter.py
```

## ç‰ˆæœ¬å†å²

### v2.1 (å½“å‰ç‰ˆæœ¬)
- æ–°å¢æ—¥æœŸæ ¼å¼æ”¯æŒï¼šyyyy-M-dã€yyyy/M/dï¼ˆä¸è¡¥é›¶ï¼‰
- æ–°å¢æ—¥æœŸæ ¼å¼æ”¯æŒï¼šHH:mmï¼ˆæ— ç§’ï¼‰
- ä¿®å¤æ—¶é—´å‘¨æœŸå‚æ•°éªŒè¯é€»è¾‘
- é‡å‘½åä¸»ç¨‹åºä¸º csv_splitter.py

### v2.0
- æ¨¡å—åŒ–ä»£ç ç»“æ„
- æ–°å¢æ—¶é—´å‘¨æœŸï¼šåŠå¹´(H)ã€åŠæœˆ(HM)
- æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º

### V1.0
- å•æ–‡ä»¶ç‰ˆæœ¬å·²å¼ƒç”¨

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
